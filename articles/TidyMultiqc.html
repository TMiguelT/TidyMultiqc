<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TidyMultiqc • TidyMultiqc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TidyMultiqc">
<meta property="og:description" content="TidyMultiqc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TidyMultiqc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TidyMultiqc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/multimeric/TidyMultiqc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="TidyMultiqc_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="TidyMultiqc_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="TidyMultiqc_files/bootstrap-3.3.5/js/bootstrap.min.js"></script><script src="TidyMultiqc_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script><script src="TidyMultiqc_files/bootstrap-3.3.5/shim/respond.min.js"></script><style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="TidyMultiqc_files/navigation-1.1/tabsets.js"></script><script src="TidyMultiqc_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="TidyMultiqc_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="TidyMultiqc_files/pagedtable-1.1/js/pagedtable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TidyMultiqc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/multimeric/TidyMultiqc/blob/master/vignettes/TidyMultiqc.Rmd"><code>vignettes/TidyMultiqc.Rmd</code></a></small>
      <div class="hidden name"><code>TidyMultiqc.Rmd</code></div>

    </div>

    
    
<div id="test-data" class="section level2">
<h2 class="hasAnchor">
<a href="#test-data" class="anchor"></a>Test Data</h2>
<p>In this example we’ll be using the WGS example report used in the MultiQC documentation. You can find view the report in your browser <a href="https://multiqc.info/examples/wgs/multiqc_report.html">here</a>, and find the associated <code>multiqc_data.json</code> file <a href="https://github.com/ewels/MultiQC_website/blob/master/public_html/examples/wgs/multiqc_data/multiqc_data.json">here</a>. Feel free to download this file and use it to follow along with this vignette.</p>
<p>In the rest of the vignette we will use the <code>multiqc_data_path</code> variable to indicate the path to this <code>multiqc_data.json</code> file. Feel free to set this variable to the path to this file on your system.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>First, install the package using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"TidyMultiqc"</span><span class="op">)</span></code></pre></div>
<p>Then if you want, you can load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/multimeric/TidyMultiqc">TidyMultiqc</a></span><span class="op">)</span></code></pre></div>
<p>However, for the sake of this tutorial we will explicitly use namespaced functions, so we won’t be using <code>library</code> a great deal.</p>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h2>
<p>The main entry point to the <code>TidyMultiqc</code> package is the function <code>load_multiqc</code>. A basic invocation of this function looks like this:</p>
<p>(note the arrow for scrolling through columns)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/load_multiqc.html">load_multiqc</a></span><span class="op">(</span><span class="va">multiqc_data_path</span><span class="op">)</span>
<span class="va">df</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["general.total_reads"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["general.mapped_reads"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["general.percentage_aligned"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["general.median_coverage"],"name":[5],"type":["int"],"align":["right"]},{"label":["general.median_insert_size"],"name":[6],"type":["int"],"align":["right"]},{"label":["general.avg_gc"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["general.1_x_pc"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["general.5_x_pc"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["general.10_x_pc"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["general.30_x_pc"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["general.50_x_pc"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["general.genome"],"name":[13],"type":["chr"],"align":["left"]},{"label":["general.number_of_variants_before_filter"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["general.number_of_known_variants_brie_non_empty_id"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["general.number_of_known_variants_brie_non_empty_id_percent"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["general.number_of_effects"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["general.genome_total_length"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["general.genome_effective_length"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["general.change_rate"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["general.high"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["general.high_percent"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["general.low"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["general.low_percent"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["general.moderate"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["general.moderate_percent"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["general.modifier"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["general.modifier_percent"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["general.missense"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["general.missense_percent"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["general.nonsense"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["general.nonsense_percent"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["general.silent"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["general.silent_percent"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["general.missense_silent_ratio"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["general.type"],"name":[36],"type":["chr"],"align":["left"]},{"label":["general.3_prime_utr_variant"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["general.3_prime_utr_variant_percent"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["general.5_prime_utr_premature_start_codon_gain_variant"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["general.5_prime_utr_premature_start_codon_gain_variant_percent"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["general.5_prime_utr_variant"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["general.5_prime_utr_variant_percent"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["general.tf_binding_site_variant"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["general.tf_binding_site_variant_percent"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["general.downstream_gene_variant"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["general.downstream_gene_variant_percent"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["general.initiator_codon_variant"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["general.initiator_codon_variant_percent"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["general.intergenic_region"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["general.intergenic_region_percent"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["general.intragenic_variant"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["general.intragenic_variant_percent"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["general.intron_variant"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["general.intron_variant_percent"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["general.missense_variant"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["general.missense_variant_percent"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["general.missense_variantsplice_region_variant"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["general.missense_variantsplice_region_variant_percent"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["general.non_coding_exon_variant"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["general.non_coding_exon_variant_percent"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["general.sequence_feature"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["general.sequence_feature_percent"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["general.sequence_featureintron_variant"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["general.sequence_featureintron_variant_percent"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantintron_variant"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantintron_variant_percent"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantsplice_donor_variantintron_variant"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantsplice_donor_variantintron_variant_percent"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantsplice_region_variantintron_variant"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["general.splice_acceptor_variantsplice_region_variantintron_variant_percent"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["general.splice_donor_variantintron_variant"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["general.splice_donor_variantintron_variant_percent"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["general.splice_donor_variantsplice_region_variantintron_variant"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["general.splice_donor_variantsplice_region_variantintron_variant_percent"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variant"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variant_percent"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantintron_variant"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantintron_variant_percent"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantnon_coding_exon_variant"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantnon_coding_exon_variant_percent"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantstop_retained_variant"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantstop_retained_variant_percent"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantsynonymous_variant"],"name":[83],"type":["dbl"],"align":["right"]},{"label":["general.splice_region_variantsynonymous_variant_percent"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["general.start_lost"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["general.start_lost_percent"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["general.start_lostsplice_region_variant"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["general.start_lostsplice_region_variant_percent"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["general.stop_gained"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["general.stop_gained_percent"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["general.stop_gainedsplice_region_variant"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["general.stop_gainedsplice_region_variant_percent"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["general.stop_lost"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["general.stop_lost_percent"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["general.stop_lostsplice_region_variant"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["general.stop_lostsplice_region_variant_percent"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["general.stop_retained_variant"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["general.stop_retained_variant_percent"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["general.synonymous_variant"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["general.synonymous_variant_percent"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["general.upstream_gene_variant"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["general.upstream_gene_variant_percent"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["general.downstream"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["general.downstream_percent"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["general.exon"],"name":[105],"type":["dbl"],"align":["right"]},{"label":["general.exon_percent"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["general.intergenic"],"name":[107],"type":["dbl"],"align":["right"]},{"label":["general.intergenic_percent"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["general.intron"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["general.intron_percent"],"name":[110],"type":["dbl"],"align":["right"]},{"label":["general.motif"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["general.motif_percent"],"name":[112],"type":["dbl"],"align":["right"]},{"label":["general.none"],"name":[113],"type":["dbl"],"align":["right"]},{"label":["general.none_percent"],"name":[114],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_acceptor"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_acceptor_percent"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_donor"],"name":[117],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_donor_percent"],"name":[118],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_region"],"name":[119],"type":["dbl"],"align":["right"]},{"label":["general.splice_site_region_percent"],"name":[120],"type":["dbl"],"align":["right"]},{"label":["general.transcript"],"name":[121],"type":["dbl"],"align":["right"]},{"label":["general.transcript_percent"],"name":[122],"type":["dbl"],"align":["right"]},{"label":["general.upstream"],"name":[123],"type":["dbl"],"align":["right"]},{"label":["general.upstream_percent"],"name":[124],"type":["dbl"],"align":["right"]},{"label":["general.utr_3_prime"],"name":[125],"type":["dbl"],"align":["right"]},{"label":["general.utr_3_prime_percent"],"name":[126],"type":["dbl"],"align":["right"]},{"label":["general.utr_5_prime"],"name":[127],"type":["dbl"],"align":["right"]},{"label":["general.utr_5_prime_percent"],"name":[128],"type":["dbl"],"align":["right"]},{"label":["general.transitions"],"name":[129],"type":["dbl"],"align":["right"]},{"label":["general.transversions"],"name":[130],"type":["dbl"],"align":["right"]},{"label":["general.ts_tv_ratio"],"name":[131],"type":["dbl"],"align":["right"]},{"label":["general.het"],"name":[132],"type":["dbl"],"align":["right"]},{"label":["general.hom"],"name":[133],"type":["dbl"],"align":["right"]},{"label":["general.missing"],"name":[134],"type":["dbl"],"align":["right"]},{"label":["general.reference"],"name":[135],"type":["chr"],"align":["left"]},{"label":["general.comp_rate"],"name":[136],"type":["dbl"],"align":["right"]},{"label":["general.concordant_rate"],"name":[137],"type":["dbl"],"align":["right"]},{"label":["general.eval_variants"],"name":[138],"type":["int"],"align":["right"]},{"label":["general.novel_sites"],"name":[139],"type":["int"],"align":["right"]},{"label":["general.known_sites"],"name":[140],"type":["int"],"align":["right"]},{"label":["general.snps"],"name":[141],"type":["int"],"align":["right"]},{"label":["general.mnps"],"name":[142],"type":["int"],"align":["right"]},{"label":["general.insertions"],"name":[143],"type":["int"],"align":["right"]},{"label":["general.deletions"],"name":[144],"type":["int"],"align":["right"]},{"label":["general.complex"],"name":[145],"type":["int"],"align":["right"]},{"label":["general.symbolic"],"name":[146],"type":["int"],"align":["right"]},{"label":["general.mixed"],"name":[147],"type":["int"],"align":["right"]},{"label":["general.nocalls"],"name":[148],"type":["int"],"align":["right"]},{"label":["general.titv_reference"],"name":[149],"type":["chr"],"align":["left"]},{"label":["general.known_titv"],"name":[150],"type":["dbl"],"align":["right"]},{"label":["general.novel_titv"],"name":[151],"type":["dbl"],"align":["right"]},{"label":["general.library"],"name":[152],"type":["chr"],"align":["left"]},{"label":["general.unpaired_reads_examined"],"name":[153],"type":["dbl"],"align":["right"]},{"label":["general.read_pairs_examined"],"name":[154],"type":["dbl"],"align":["right"]},{"label":["general.unmapped_reads"],"name":[155],"type":["dbl"],"align":["right"]},{"label":["general.unpaired_read_duplicates"],"name":[156],"type":["dbl"],"align":["right"]},{"label":["general.read_pair_duplicates"],"name":[157],"type":["dbl"],"align":["right"]},{"label":["general.read_pair_optical_duplicates"],"name":[158],"type":["dbl"],"align":["right"]},{"label":["general.percent_duplication"],"name":[159],"type":["dbl"],"align":["right"]},{"label":["general.estimated_library_size"],"name":[160],"type":["dbl"],"align":["right"]},{"label":["general.percent_gc"],"name":[161],"type":["dbl"],"align":["right"]},{"label":["general.avg_sequence_length"],"name":[162],"type":["dbl"],"align":["right"]},{"label":["general.total_sequences"],"name":[163],"type":["dbl"],"align":["right"]},{"label":["general.percent_duplicates"],"name":[164],"type":["dbl"],"align":["right"]},{"label":["general.percent_fails"],"name":[165],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1003","2":"868204107","3":"847562410","4":"97.62248","5":"40","6":"365","7":"41.35698","8":"92.29751","9":"92.22753","10":"92.07815","11":"82.37847","12":"16.220900","13":"GRCh37.75","14":"4072201","15":"3872914","16":"95.10616","17":"21162478","18":"32036512383","19":"3101728650","20":"761","21":"1314","22":"0.006209","23":"8434737","24":"39.85704","25":"38739","26":"0.183055","27":"12687688","28":"59.95370","29":"31843","30":"46.62089","31":"323","32":"0.472900","33":"36136","34":"52.90621","35":"0.881199","36":"Count","37":"65612","38":"0.310039","39":"3043","40":"0.014379","41":"20798","42":"0.098278","43":"4252","44":"0.020092","45":"1247406","46":"5.894423","47":"9","48":"4.3e-05","49":"2060392","50":"9.736062","51":"675","52":"0.003190","53":"7911861","54":"37.38627","55":"30977","56":"0.146377","57":"740","58":"0.003497","59":"124878","60":"0.590092","61":"8388529","62":"39.63869","63":"6","64":"2.8e-05","65":"366","66":"0.001729","67":"3","68":"1.4e-05","69":"2","70":"9e-06","71":"502","72":"0.002372","73":"1","74":"5e-06","75":"463","76":"0.002188","77":"10215","78":"0.048269","79":"1859","80":"0.008784","81":"5","82":"2.4e-05","83":"910","84":"0.004300","85":"61","86":"0.000288","87":"4","88":"1.9e-05","89":"320","90":"0.001512","91":"3","92":"1.4e-05","93":"44","94":"0.000208","95":"8","96":"3.8e-05","97":"43","98":"0.000203","99":"35178","100":"0.166228","101":"1253313","102":"5.922336","103":"1247406","104":"5.894423","105":"192191","106":"0.908169","107":"2060392","108":"9.736062","109":"7911861","110":"37.38627","111":"4252","112":"0.020092","113":"8389210","114":"39.64191","115":"371","116":"0.001753","117":"503","118":"0.002377","119":"13452","120":"0.063565","121":"74","122":"0.000350","123":"1253313","124":"5.922336","125":"65612","126":"0.310039","127":"23841","128":"0.112657","129":"3716534","130":"1864090","131":"1.993752","132":"2560300","133":"1510162","134":"0","135":"hapmap","136":"44.76","137":"99.08","138":"3545454","139":"1958486","140":"3473340","141":"3545454","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.47","152":"A","153":"1115159","154":"420500572","155":"20641697","156":"466283","157":"43865124","158":"9404573","159":"0.104732","160":"2313040870","161":"41","162":"151","163":"431379000","164":"6.795406","165":"8.333333"},{"1":"P4107_1004","2":"1002828927","3":"985115356","4":"98.23364","5":"46","6":"363","7":"40.99307","8":"92.29609","9":"92.23238","10":"92.07642","11":"84.74394","12":"40.455066","13":"GRCh37.75","14":"4052117","15":"3860097","16":"95.26124","17":"21093227","18":"32036512383","19":"3101541615","20":"765","21":"1279","22":"0.006064","23":"8417008","24":"39.90384","25":"38431","26":"0.182196","27":"12636509","28":"59.90790","29":"31517","30":"46.54085","31":"308","32":"0.454821","33":"35894","34":"53.00433","35":"0.878058","36":"Count","37":"65176","38":"0.308990","39":"3024","40":"0.014336","41":"20770","42":"0.098468","43":"4267","44":"0.020229","45":"1239681","46":"5.877152","47":"10","48":"4.7e-05","49":"2047249","50":"9.705717","51":"674","52":"0.003195","53":"7890065","54":"37.40568","55":"30662","56":"0.145364","57":"729","58":"0.003456","59":"123785","60":"0.586847","61":"8371134","62":"39.68636","63":"6","64":"2.8e-05","65":"356","66":"0.001688","67":"4","68":"1.9e-05","69":"1","70":"5e-06","71":"494","72":"0.002342","73":"NA","74":"NA","75":"455","76":"0.002157","77":"10160","78":"0.048167","79":"1861","80":"0.008823","81":"5","82":"2.4e-05","83":"899","84":"0.004262","85":"61","86":"0.000289","87":"4","88":"1.9e-05","89":"305","90":"0.001446","91":"3","92":"1.4e-05","93":"43","94":"0.000204","95":"8","96":"3.8e-05","97":"42","98":"0.000199","99":"34948","100":"0.165684","101":"1246346","102":"5.908750","103":"1239681","104":"5.877152","105":"190525","106":"0.903252","107":"2047249","108":"9.705717","109":"7890065","110":"37.40568","111":"4267","112":"0.020229","113":"8371814","114":"39.68958","115":"361","116":"0.001711","117":"494","118":"0.002342","119":"13380","120":"0.063433","121":"75","122":"0.000356","123":"1246346","124":"5.908750","125":"65176","126":"0.308990","127":"23794","128":"0.112804","129":"3703540","130":"1855247","131":"1.996252","132":"2542103","133":"1508342","134":"0","135":"hapmap","136":"45.84","137":"99.09","138":"3457524","139":"1872505","140":"3414528","141":"3457524","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.49","152":"A","153":"917143","154":"488850042","155":"17713571","156":"618736","157":"192412570","158":"50767101","159":"0.393866","160":"521814268","161":"40","162":"151","163":"498165399","164":"3.940428","165":"16.666667"},{"1":"P4107_1005","2":"974955793","3":"955921317","4":"98.04766","5":"45","6":"368","7":"41.17478","8":"92.29828","9":"92.23468","10":"92.11250","11":"85.26307","12":"35.614453","13":"GRCh37.75","14":"4069620","15":"3871067","16":"95.12109","17":"21160008","18":"32036512383","19":"3101541615","20":"762","21":"1309","22":"0.006186","23":"8435386","24":"39.86476","25":"38702","26":"0.182902","27":"12684611","28":"59.94615","29":"31743","30":"46.59249","31":"320","32":"0.469697","33":"36066","34":"52.93781","35":"0.880136","36":"Count","37":"65680","38":"0.310397","39":"3040","40":"0.014367","41":"20784","42":"0.098223","43":"4258","44":"0.020123","45":"1246085","46":"5.888868","47":"10","48":"4.7e-05","49":"2057863","50":"9.725247","51":"675","52":"0.003190","53":"7911193","54":"37.38748","55":"30871","56":"0.145893","57":"744","58":"0.003516","59":"124929","60":"0.590401","61":"8389292","62":"39.64692","63":"6","64":"2.8e-05","65":"365","66":"0.001725","67":"6","68":"2.8e-05","69":"1","70":"5e-06","71":"498","72":"0.002353","73":"1","74":"5e-06","75":"454","76":"0.002146","77":"10213","78":"0.048266","79":"1876","80":"0.008866","81":"5","82":"2.4e-05","83":"904","84":"0.004272","85":"61","86":"0.000288","87":"4","88":"1.9e-05","89":"317","90":"0.001498","91":"3","92":"1.4e-05","93":"44","94":"0.000208","95":"9","96":"4.3e-05","97":"42","98":"0.000198","99":"35115","100":"0.165950","101":"1254660","102":"5.929393","103":"1246085","104":"5.888868","105":"192074","106":"0.907722","107":"2057863","108":"9.725247","109":"7911193","110":"37.38748","111":"4258","112":"0.020123","113":"8389973","114":"39.65014","115":"372","116":"0.001758","117":"499","118":"0.002358","119":"13452","120":"0.063573","121":"75","122":"0.000354","123":"1254660","124":"5.929393","125":"65680","126":"0.310397","127":"23824","128":"0.112590","129":"3714461","130":"1863082","131":"1.993718","132":"2558281","133":"1509631","134":"0","135":"hapmap","136":"45.82","137":"99.10","138":"3459835","139":"1874662","140":"3416662","141":"3459835","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.46","152":"A","153":"1184584","154":"474123896","155":"19034476","156":"655331","157":"115911990","158":"32539725","159":"0.244861","160":"1017071922","161":"41","162":"151","163":"484233426","164":"6.603659","165":"8.333333"},{"1":"P4107_1002","2":"865975844","3":"847067526","4":"97.81653","5":"40","6":"367","7":"41.29062","8":"92.29794","9":"92.22694","10":"92.07669","11":"82.33886","12":"15.934603","13":"GRCh37.75","14":"4067653","15":"3870535","16":"95.15401","17":"21143436","18":"32036512383","19":"3101728650","20":"762","21":"1319","22":"0.006238","23":"8428911","24":"39.86538","25":"38681","26":"0.182946","27":"12674525","28":"59.94544","29":"31778","30":"46.67470","31":"313","32":"0.459726","33":"35993","34":"52.86558","35":"0.882894","36":"Count","37":"65659","38":"0.310541","39":"3033","40":"0.014345","41":"20819","42":"0.098466","43":"4254","44":"0.020120","45":"1246143","46":"5.893758","47":"10","48":"4.7e-05","49":"2057338","50":"9.730386","51":"676","52":"0.003197","53":"7903237","54":"37.37915","55":"30932","56":"0.146296","57":"722","58":"0.003415","59":"125010","60":"0.591247","61":"8382886","62":"39.64770","63":"6","64":"2.8e-05","65":"358","66":"0.001693","67":"3","68":"1.4e-05","69":"1","70":"5e-06","71":"530","72":"0.002507","73":"NA","74":"NA","75":"454","76":"0.002147","77":"10207","78":"0.048275","79":"1870","80":"0.008844","81":"5","82":"2.4e-05","83":"915","84":"0.004328","85":"61","86":"0.000289","87":"4","88":"1.9e-05","89":"310","90":"0.001466","91":"3","92":"1.4e-05","93":"43","94":"0.000203","95":"6","96":"2.8e-05","97":"42","98":"0.000199","99":"35031","100":"0.165683","101":"1252868","102":"5.925565","103":"1246143","104":"5.893758","105":"192099","106":"0.908551","107":"2057338","108":"9.730386","109":"7903237","110":"37.37915","111":"4254","112":"0.020120","113":"8383568","114":"39.65093","115":"362","116":"0.001712","117":"530","118":"0.002507","119":"13451","120":"0.063618","121":"75","122":"0.000355","123":"1252868","124":"5.925565","125":"65659","126":"0.310541","127":"23852","128":"0.112810","129":"3713295","130":"1861933","131":"1.994323","132":"2556640","133":"1509294","134":"0","135":"hapmap","136":"45.75","137":"99.09","138":"3465116","139":"1879862","140":"3421917","141":"3465116","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.48","152":"A","153":"1185838","154":"420138446","155":"18908318","156":"483800","157":"41401574","158":"8561816","159":"0.098979","160":"2440020860","161":"41","162":"151","163":"430185524","164":"2.158076","165":"16.666667"},{"1":"P4107_1006","2":"912383669","3":"894970438","4":"98.09146","5":"43","6":"362","7":"41.26998","8":"92.29880","9":"92.23074","10":"92.10217","11":"84.09636","12":"23.664833","13":"GRCh37.75","14":"4072161","15":"3872603","16":"95.09946","17":"21155209","18":"32036512383","19":"3101541615","20":"761","21":"1309","22":"0.006188","23":"8428017","24":"39.83897","25":"38700","26":"0.182934","27":"12687183","28":"59.97191","29":"31791","30":"46.62052","31":"315","32":"0.461938","33":"36085","34":"52.91754","35":"0.881003","36":"Count","37":"65469","38":"0.309470","39":"3038","40":"0.014361","41":"20738","42":"0.098028","43":"4237","44":"0.020028","45":"1247269","46":"5.895801","47":"8","48":"3.8e-05","49":"2060065","50":"9.737862","51":"675","52":"0.003191","53":"7910832","54":"37.39425","55":"30926","56":"0.146186","57":"739","58":"0.003493","59":"124984","60":"0.590795","61":"8381858","62":"39.62078","63":"6","64":"2.8e-05","65":"359","66":"0.001697","67":"3","68":"1.4e-05","69":"1","70":"5e-06","71":"513","72":"0.002425","73":"NA","74":"NA","75":"450","76":"0.002127","77":"10247","78":"0.048437","79":"1865","80":"0.008816","81":"5","82":"2.4e-05","83":"904","84":"0.004273","85":"61","86":"0.000288","87":"4","88":"1.9e-05","89":"312","90":"0.001475","91":"3","92":"1.4e-05","93":"45","94":"0.000213","95":"8","96":"3.8e-05","97":"45","98":"0.000213","99":"35131","100":"0.166063","101":"1254409","102":"5.929551","103":"1247269","104":"5.895801","105":"192193","106":"0.908490","107":"2060065","108":"9.737862","109":"7910832","110":"37.39425","111":"4237","112":"0.020028","113":"8382539","114":"39.62400","115":"363","116":"0.001716","117":"513","118":"0.002425","119":"13471","120":"0.063677","121":"73","122":"0.000345","123":"1254409","124":"5.929551","125":"65469","126":"0.309470","127":"23776","128":"0.112388","129":"3716115","130":"1864190","131":"1.993421","132":"2560545","133":"1509880","134":"0","135":"hapmap","136":"45.91","137":"99.10","138":"3452732","139":"1867441","140":"3410273","141":"3452732","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.48","152":"A","153":"1310769","154":"443876610","155":"17413231","156":"556444","157":"55005596","158":"13645138","159":"0.124364","160":"2091799585","161":"41","162":"151","163":"453238610","164":"1.775882","165":"8.333333"},{"1":"P4107_1001","2":"772071557","3":"751147332","4":"97.28986","5":"36","6":"358","7":"41.36746","8":"92.29433","9":"92.21026","10":"91.96108","11":"74.66019","12":"5.240211","13":"GRCh37.75","14":"4059325","15":"3864874","16":"95.20977","17":"21116726","18":"32036512383","19":"3101541615","20":"764","21":"1296","22":"0.006137","23":"8421056","24":"39.87861","25":"38519","26":"0.182410","27":"12655855","28":"59.93285","29":"31604","30":"46.58402","31":"311","32":"0.458411","33":"35928","34":"52.95756","35":"0.879648","36":"Count","37":"65517","38":"0.310261","39":"3029","40":"0.014344","41":"20806","42":"0.098529","43":"4226","44":"0.020013","45":"1243319","46":"5.887840","47":"10","48":"4.7e-05","49":"2052490","50":"9.719736","51":"675","52":"0.003197","53":"7895710","54":"37.39079","55":"30730","56":"0.145524","57":"747","58":"0.003537","59":"124583","60":"0.589973","61":"8375083","62":"39.66090","63":"6","64":"2.8e-05","65":"370","66":"0.001752","67":"5","68":"2.4e-05","69":"1","70":"5e-06","71":"492","72":"0.002330","73":"NA","74":"NA","75":"462","76":"0.002188","77":"10231","78":"0.048450","79":"1838","80":"0.008704","81":"5","82":"2.4e-05","83":"892","84":"0.004224","85":"61","86":"0.000289","87":"4","88":"1.9e-05","89":"309","90":"0.001463","91":"2","92":"9.0e-06","93":"44","94":"0.000208","95":"8","96":"3.8e-05","97":"43","98":"0.000204","99":"34988","100":"0.165689","101":"1250040","102":"5.919668","103":"1243319","104":"5.887840","105":"191454","106":"0.906646","107":"2052490","108":"9.719736","109":"7895710","110":"37.39079","111":"4226","112":"0.020013","113":"8375764","114":"39.66412","115":"376","116":"0.001781","117":"492","118":"0.002330","119":"13428","120":"0.063589","121":"75","122":"0.000355","123":"1250040","124":"5.919668","125":"65517","126":"0.310261","127":"23835","128":"0.112873","129":"3708090","130":"1858534","131":"1.995169","132":"2548668","133":"1508978","134":"0","135":"hapmap","136":"45.44","137":"99.09","138":"3490344","139":"1904260","140":"3437854","141":"3490344","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"0","149":"hapmap","150":"2.07","151":"1.49","152":"A","153":"1351481","154":"372454903","155":"20924225","156":"449788","157":"23612037","158":"4105864","159":"0.063884","160":"3354000974","161":"41","162":"151","163":"383592756","164":"3.693292","165":"16.666667"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We’ve now generated a <code>tibble</code> (a kind of data frame), whose rows are samples in the QC report, and whose columns are QC data and metadata about these samples.</p>
<p>By default this function only returns the “general” statistics, which are the ones in the “General Statistics” table at the top of the MultiQC report. In TidyMultiqc, these statistics are all prefixed by <code>general.</code> We can also extract the “raw” statistics, which includes some fields normally hidden from the report. These statistics will have the prefix <code>raw.&lt;toolname&gt;.</code> where <code>&lt;toolname&gt;</code> is the QC tool used to calculate it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/load_multiqc.html">load_multiqc</a></span><span class="op">(</span><span class="va">multiqc_data_path</span>, sections <span class="op">=</span> <span class="st">'raw'</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["raw.qualimap_bamqc_genome_results.bam_file"],"name":[2],"type":["chr"],"align":["left"]},{"label":["raw.qualimap_bamqc_genome_results.total_reads"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.mapped_reads"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.mapped_bases"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.sequenced_bases"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.mean_insert_size"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.median_insert_size"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.mean_mapping_quality"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.mean_coverage"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["raw.qualimap_bamqc_genome_results.percentage_aligned"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.genome"],"name":[12],"type":["chr"],"align":["left"]},{"label":["raw.snpeff.number_of_variants_before_filter"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.empty_id"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.empty_id_percent"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.number_of_effects"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.genome_total_length"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.genome_effective_length"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.change_rate"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.high"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.high_percent"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.low"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.low_percent"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.moderate"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.moderate_percent"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.modifier"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.modifier_percent"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_percent"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.nonsense"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.nonsense_percent"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.silent"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.silent_percent"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_silent_ratio"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.type"],"name":[35],"type":["chr"],"align":["left"]},{"label":["raw.snpeff.3_prime_utr_variant"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.3_prime_utr_variant_percent"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.5_prime_utr_premature_start_codon_gain_variant"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.5_prime_utr_premature_start_codon_gain_variant_percent"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.5_prime_utr_variant"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.5_prime_utr_variant_percent"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.tf_binding_site_variant"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.tf_binding_site_variant_percent"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.downstream_gene_variant"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.downstream_gene_variant_percent"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.initiator_codon_variant"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.initiator_codon_variant_percent"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intergenic_region"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intergenic_region_percent"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intragenic_variant"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intragenic_variant_percent"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intron_variant"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intron_variant_percent"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_variant"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_variant_percent"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_variantsplice_region_variant"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missense_variantsplice_region_variant_percent"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.non_coding_exon_variant"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.non_coding_exon_variant_percent"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.sequence_feature"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.sequence_feature_percent"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.sequence_featureintron_variant"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.sequence_featureintron_variant_percent"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantintron_variant"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantintron_variant_percent"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantsplice_donor_variantintron_variant"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantsplice_donor_variantintron_variant_percent"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantsplice_region_variantintron_variant"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_acceptor_variantsplice_region_variantintron_variant_percent"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_donor_variantintron_variant"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_donor_variantintron_variant_percent"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_donor_variantsplice_region_variantintron_variant"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_donor_variantsplice_region_variantintron_variant_percent"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variant"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variant_percent"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantintron_variant"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantintron_variant_percent"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantnon_coding_exon_variant"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantnon_coding_exon_variant_percent"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantstop_retained_variant"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantstop_retained_variant_percent"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantsynonymous_variant"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_region_variantsynonymous_variant_percent"],"name":[83],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.start_lost"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.start_lost_percent"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.start_lostsplice_region_variant"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.start_lostsplice_region_variant_percent"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_gained"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_gained_percent"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_gainedsplice_region_variant"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_gainedsplice_region_variant_percent"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_lost"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_lost_percent"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_lostsplice_region_variant"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_lostsplice_region_variant_percent"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_retained_variant"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.stop_retained_variant_percent"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.synonymous_variant"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.synonymous_variant_percent"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.upstream_gene_variant"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.upstream_gene_variant_percent"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.downstream"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.downstream_percent"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.exon"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.exon_percent"],"name":[105],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intergenic"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intergenic_percent"],"name":[107],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intron"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.intron_percent"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.motif"],"name":[110],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.motif_percent"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.none"],"name":[112],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.none_percent"],"name":[113],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_acceptor"],"name":[114],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_acceptor_percent"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_donor"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_donor_percent"],"name":[117],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_region"],"name":[118],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.splice_site_region_percent"],"name":[119],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.transcript"],"name":[120],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.transcript_percent"],"name":[121],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.upstream"],"name":[122],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.upstream_percent"],"name":[123],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.utr_3_prime"],"name":[124],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.utr_3_prime_percent"],"name":[125],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.utr_5_prime"],"name":[126],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.utr_5_prime_percent"],"name":[127],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.transitions"],"name":[128],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.transversions"],"name":[129],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.ts_tv_ratio"],"name":[130],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.het"],"name":[131],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.hom"],"name":[132],"type":["dbl"],"align":["right"]},{"label":["raw.snpeff.missing"],"name":[133],"type":["dbl"],"align":["right"]},{"label":["raw.gatk_varianteval.reference"],"name":[134],"type":["chr"],"align":["left"]},{"label":["raw.gatk_varianteval.comp_rate"],"name":[135],"type":["dbl"],"align":["right"]},{"label":["raw.gatk_varianteval.concordant_rate"],"name":[136],"type":["dbl"],"align":["right"]},{"label":["raw.gatk_varianteval.eval_variants"],"name":[137],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.novel_sites"],"name":[138],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.known_sites"],"name":[139],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.snps"],"name":[140],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.mnps"],"name":[141],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.insertions"],"name":[142],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.deletions"],"name":[143],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.complex"],"name":[144],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.symbolic"],"name":[145],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.mixed"],"name":[146],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.nocalls"],"name":[147],"type":["int"],"align":["right"]},{"label":["raw.gatk_varianteval.titv_reference"],"name":[148],"type":["chr"],"align":["left"]},{"label":["raw.gatk_varianteval.known_titv"],"name":[149],"type":["dbl"],"align":["right"]},{"label":["raw.gatk_varianteval.novel_titv"],"name":[150],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.library"],"name":[151],"type":["chr"],"align":["left"]},{"label":["raw.picard_dups.unpaired_reads_examined"],"name":[152],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.read_pairs_examined"],"name":[153],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.unmapped_reads"],"name":[154],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.unpaired_read_duplicates"],"name":[155],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.read_pair_duplicates"],"name":[156],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.read_pair_optical_duplicates"],"name":[157],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.percent_duplication"],"name":[158],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.estimated_library_size"],"name":[159],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_duplicate_pairs"],"name":[160],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_unique_pairs"],"name":[161],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_unique_unpaired"],"name":[162],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_duplicate_pairs_optical"],"name":[163],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_duplicate_pairs_nonoptical"],"name":[164],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_in_duplicate_unpaired"],"name":[165],"type":["dbl"],"align":["right"]},{"label":["raw.picard_dups.reads_unmapped"],"name":[166],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.total_reads"],"name":[167],"type":["int"],"align":["right"]},{"label":["raw.fastq_screen.cfamiliaris_counts"],"name":[168],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.cfamiliaris_percentage"],"name":[169],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.dmelanogaster_counts"],"name":[170],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.dmelanogaster_percentage"],"name":[171],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.human_counts"],"name":[172],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.human_percentage"],"name":[173],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.mouse_counts"],"name":[174],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.mouse_percentage"],"name":[175],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.phix_counts"],"name":[176],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.phix_percentage"],"name":[177],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.xtropicalis_counts"],"name":[178],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.xtropicalis_percentage"],"name":[179],"type":["dbl"],"align":["right"]},{"label":["raw.fastq_screen.no_hits_counts"],"name":[180],"type":["int"],"align":["right"]},{"label":["raw.fastq_screen.no_hits_percentage"],"name":[181],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.filename"],"name":[182],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.file_type"],"name":[183],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.encoding"],"name":[184],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.total_sequences"],"name":[185],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.sequences_flagged_as_poor_quality"],"name":[186],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.sequence_length"],"name":[187],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.%gc"],"name":[188],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.total_deduplicated_percentage"],"name":[189],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.avg_sequence_length"],"name":[190],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.basic_statistics"],"name":[191],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_base_sequence_quality"],"name":[192],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_tile_sequence_quality"],"name":[193],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_sequence_quality_scores"],"name":[194],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_base_sequence_content"],"name":[195],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_sequence_gc_content"],"name":[196],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_base_n_content"],"name":[197],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.sequence_length_distribution"],"name":[198],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.sequence_duplication_levels"],"name":[199],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.overrepresented_sequences"],"name":[200],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.adapter_content"],"name":[201],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.kmer_content"],"name":[202],"type":["chr"],"align":["left"]},{"label":["raw.general_stats.avg_gc"],"name":[203],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.median_insert_size"],"name":[204],"type":["int"],"align":["right"]},{"label":["raw.general_stats.1_x_pc"],"name":[205],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.5_x_pc"],"name":[206],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.10_x_pc"],"name":[207],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.30_x_pc"],"name":[208],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.50_x_pc"],"name":[209],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.median_coverage"],"name":[210],"type":["int"],"align":["right"]},{"label":["raw.general_stats.percentage_aligned"],"name":[211],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.mapped_reads"],"name":[212],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.total_reads"],"name":[213],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.change_rate"],"name":[214],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.ts_tv_ratio"],"name":[215],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.number_of_variants_before_filter"],"name":[216],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.known_titv"],"name":[217],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.novel_titv"],"name":[218],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.percent_duplication"],"name":[219],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.percent_duplicates"],"name":[220],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.percent_gc"],"name":[221],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.avg_sequence_length"],"name":[222],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.percent_fails"],"name":[223],"type":["dbl"],"align":["right"]},{"label":["raw.general_stats.total_sequences"],"name":[224],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1003","2":"/scratch/109642/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1003.clean.dedup.bam","3":"868204107","4":"847562410","5":"125495980571","6":"125419666954","7":"28161.14","8":"363","9":"50.34","10":"40.46","11":"97.62248","12":"GRCh37.75","13":"4072201","14":"3872914","15":"95.10616","16":"21162478","17":"32036512383","18":"3101728650","19":"761","20":"1314","21":"0.006209","22":"8434737","23":"39.85704","24":"38739","25":"0.183055","26":"12687688","27":"59.95370","28":"31843","29":"46.62089","30":"323","31":"0.472900","32":"36136","33":"52.90621","34":"0.881199","35":"Count","36":"65612","37":"0.310039","38":"3043","39":"0.014379","40":"20798","41":"0.098278","42":"4252","43":"0.020092","44":"1247406","45":"5.894423","46":"9","47":"4.3e-05","48":"2060392","49":"9.736062","50":"675","51":"0.003190","52":"7911861","53":"37.38627","54":"30977","55":"0.146377","56":"740","57":"0.003497","58":"124878","59":"0.590092","60":"8388529","61":"39.63869","62":"6","63":"2.8e-05","64":"366","65":"0.001729","66":"3","67":"1.4e-05","68":"2","69":"9e-06","70":"502","71":"0.002372","72":"1","73":"5e-06","74":"463","75":"0.002188","76":"10215","77":"0.048269","78":"1859","79":"0.008784","80":"5","81":"2.4e-05","82":"910","83":"0.004300","84":"61","85":"0.000288","86":"4","87":"1.9e-05","88":"320","89":"0.001512","90":"3","91":"1.4e-05","92":"44","93":"0.000208","94":"8","95":"3.8e-05","96":"43","97":"0.000203","98":"35178","99":"0.166228","100":"1253313","101":"5.922336","102":"1247406","103":"5.894423","104":"192191","105":"0.908169","106":"2060392","107":"9.736062","108":"7911861","109":"37.38627","110":"4252","111":"0.020092","112":"8389210","113":"39.64191","114":"371","115":"0.001753","116":"503","117":"0.002377","118":"13452","119":"0.063565","120":"74","121":"0.000350","122":"1253313","123":"5.922336","124":"65612","125":"0.310039","126":"23841","127":"0.112657","128":"3716534","129":"1864090","130":"1.993752","131":"2560300","132":"1510162","133":"0","134":"hapmap","135":"44.76","136":"99.08","137":"3545454","138":"1958486","139":"3473340","140":"3545454","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.47","151":"A","152":"1115159","153":"420500572","154":"20641697","155":"466283","156":"43865124","157":"9404573","158":"0.104732","159":"2313040870","160":"87730248","161":"753270896","162":"648876","163":"18809146","164":"68921102","165":"466283","166":"20641697","167":"199991","168":"0","169":"0","170":"6648","171":"3.33","172":"192581","173":"96.30","174":"19335","175":"9.68","176":"4","177":"0.00","178":"17998","179":"9.00","180":"7319","181":"3.66","182":"P4107_1003_S3_L004_R1_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"431379000","186":"0","187":"151","188":"41","189":"93.20459","190":"151","191":"pass","192":"pass","193":"warn","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"warn","201":"pass","202":"fail","203":"41.35698","204":"365","205":"92.29751","206":"92.22753","207":"92.07815","208":"82.37847","209":"16.220900","210":"40","211":"97.62248","212":"847562410","213":"868204107","214":"761","215":"1.993752","216":"4072201","217":"2.07","218":"1.47","219":"0.104732","220":"6.795406","221":"41","222":"151","223":"8.333333","224":"431379000"},{"1":"P4107_1004","2":"/scratch/108816/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1004.clean.dedup.bam","3":"1002828927","4":"985115356","5":"145914179420","6":"145832795553","7":"28253.13","8":"361","9":"50.37","10":"47.04","11":"98.23364","12":"GRCh37.75","13":"4052117","14":"3860097","15":"95.26124","16":"21093227","17":"32036512383","18":"3101541615","19":"765","20":"1279","21":"0.006064","22":"8417008","23":"39.90384","24":"38431","25":"0.182196","26":"12636509","27":"59.90790","28":"31517","29":"46.54085","30":"308","31":"0.454821","32":"35894","33":"53.00433","34":"0.878058","35":"Count","36":"65176","37":"0.308990","38":"3024","39":"0.014336","40":"20770","41":"0.098468","42":"4267","43":"0.020229","44":"1239681","45":"5.877152","46":"10","47":"4.7e-05","48":"2047249","49":"9.705717","50":"674","51":"0.003195","52":"7890065","53":"37.40568","54":"30662","55":"0.145364","56":"729","57":"0.003456","58":"123785","59":"0.586847","60":"8371134","61":"39.68636","62":"6","63":"2.8e-05","64":"356","65":"0.001688","66":"4","67":"1.9e-05","68":"1","69":"5e-06","70":"494","71":"0.002342","72":"NA","73":"NA","74":"455","75":"0.002157","76":"10160","77":"0.048167","78":"1861","79":"0.008823","80":"5","81":"2.4e-05","82":"899","83":"0.004262","84":"61","85":"0.000289","86":"4","87":"1.9e-05","88":"305","89":"0.001446","90":"3","91":"1.4e-05","92":"43","93":"0.000204","94":"8","95":"3.8e-05","96":"42","97":"0.000199","98":"34948","99":"0.165684","100":"1246346","101":"5.908750","102":"1239681","103":"5.877152","104":"190525","105":"0.903252","106":"2047249","107":"9.705717","108":"7890065","109":"37.40568","110":"4267","111":"0.020229","112":"8371814","113":"39.68958","114":"361","115":"0.001711","116":"494","117":"0.002342","118":"13380","119":"0.063433","120":"75","121":"0.000356","122":"1246346","123":"5.908750","124":"65176","125":"0.308990","126":"23794","127":"0.112804","128":"3703540","129":"1855247","130":"1.996252","131":"2542103","132":"1508342","133":"0","134":"hapmap","135":"45.84","136":"99.09","137":"3457524","138":"1872505","139":"3414528","140":"3457524","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.49","151":"A","152":"917143","153":"488850042","154":"17713571","155":"618736","156":"192412570","157":"50767101","158":"0.393866","159":"521814268","160":"384825140","161":"592874944","162":"298407","163":"101534202","164":"283290938","165":"618736","166":"17713571","167":"199987","168":"0","169":"0","170":"6327","171":"3.16","172":"194099","173":"97.06","174":"19085","175":"9.54","176":"1","177":"0.00","178":"17397","179":"8.69","180":"5839","181":"2.92","182":"P4107_1004_S4_L005_R1_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"498165399","186":"0","187":"151","188":"40","189":"96.05957","190":"151","191":"pass","192":"pass","193":"fail","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"warn","201":"pass","202":"fail","203":"40.99307","204":"363","205":"92.29609","206":"92.23238","207":"92.07642","208":"84.74394","209":"40.455066","210":"46","211":"98.23364","212":"985115356","213":"1002828927","214":"765","215":"1.996252","216":"4052117","217":"2.07","218":"1.49","219":"0.393866","220":"3.940428","221":"40","222":"151","223":"16.666667","224":"498165399"},{"1":"P4107_1005","2":"/scratch/108818/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1005.clean.dedup.bam","3":"974955793","4":"955921317","5":"141381675087","6":"141297632099","7":"30723.18","8":"365","9":"50.34","10":"45.58","11":"98.04766","12":"GRCh37.75","13":"4069620","14":"3871067","15":"95.12109","16":"21160008","17":"32036512383","18":"3101541615","19":"762","20":"1309","21":"0.006186","22":"8435386","23":"39.86476","24":"38702","25":"0.182902","26":"12684611","27":"59.94615","28":"31743","29":"46.59249","30":"320","31":"0.469697","32":"36066","33":"52.93781","34":"0.880136","35":"Count","36":"65680","37":"0.310397","38":"3040","39":"0.014367","40":"20784","41":"0.098223","42":"4258","43":"0.020123","44":"1246085","45":"5.888868","46":"10","47":"4.7e-05","48":"2057863","49":"9.725247","50":"675","51":"0.003190","52":"7911193","53":"37.38748","54":"30871","55":"0.145893","56":"744","57":"0.003516","58":"124929","59":"0.590401","60":"8389292","61":"39.64692","62":"6","63":"2.8e-05","64":"365","65":"0.001725","66":"6","67":"2.8e-05","68":"1","69":"5e-06","70":"498","71":"0.002353","72":"1","73":"5e-06","74":"454","75":"0.002146","76":"10213","77":"0.048266","78":"1876","79":"0.008866","80":"5","81":"2.4e-05","82":"904","83":"0.004272","84":"61","85":"0.000288","86":"4","87":"1.9e-05","88":"317","89":"0.001498","90":"3","91":"1.4e-05","92":"44","93":"0.000208","94":"9","95":"4.3e-05","96":"42","97":"0.000198","98":"35115","99":"0.165950","100":"1254660","101":"5.929393","102":"1246085","103":"5.888868","104":"192074","105":"0.907722","106":"2057863","107":"9.725247","108":"7911193","109":"37.38748","110":"4258","111":"0.020123","112":"8389973","113":"39.65014","114":"372","115":"0.001758","116":"499","117":"0.002358","118":"13452","119":"0.063573","120":"75","121":"0.000354","122":"1254660","123":"5.929393","124":"65680","125":"0.310397","126":"23824","127":"0.112590","128":"3714461","129":"1863082","130":"1.993718","131":"2558281","132":"1509631","133":"0","134":"hapmap","135":"45.82","136":"99.10","137":"3459835","138":"1874662","139":"3416662","140":"3459835","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.46","151":"A","152":"1184584","153":"474123896","154":"19034476","155":"655331","156":"115911990","157":"32539725","158":"0.244861","159":"1017071922","160":"231823980","161":"716423812","162":"529253","163":"65079450","164":"166744530","165":"655331","166":"19034476","167":"200014","168":"0","169":"0","170":"6775","171":"3.39","172":"194923","173":"97.46","174":"19897","175":"9.94","176":"8","177":"0.00","178":"18488","179":"9.25","180":"5040","181":"2.52","182":"P4107_1005_S5_L006_R2_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"484233426","186":"0","187":"151","188":"41","189":"93.39634","190":"151","191":"pass","192":"pass","193":"warn","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"warn","201":"pass","202":"fail","203":"41.17478","204":"368","205":"92.29828","206":"92.23468","207":"92.11250","208":"85.26307","209":"35.614453","210":"45","211":"98.04766","212":"955921317","213":"974955793","214":"762","215":"1.993718","216":"4069620","217":"2.07","218":"1.46","219":"0.244861","220":"6.603659","221":"41","222":"151","223":"8.333333","224":"484233426"},{"1":"P4107_1002","2":"/scratch/108825/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1002.clean.dedup.bam","3":"865975844","4":"847067526","5":"125247746115","6":"125167789762","7":"29317.24","8":"364","9":"50.33","10":"40.38","11":"97.81653","12":"GRCh37.75","13":"4067653","14":"3870535","15":"95.15401","16":"21143436","17":"32036512383","18":"3101728650","19":"762","20":"1319","21":"0.006238","22":"8428911","23":"39.86538","24":"38681","25":"0.182946","26":"12674525","27":"59.94544","28":"31778","29":"46.67470","30":"313","31":"0.459726","32":"35993","33":"52.86558","34":"0.882894","35":"Count","36":"65659","37":"0.310541","38":"3033","39":"0.014345","40":"20819","41":"0.098466","42":"4254","43":"0.020120","44":"1246143","45":"5.893758","46":"10","47":"4.7e-05","48":"2057338","49":"9.730386","50":"676","51":"0.003197","52":"7903237","53":"37.37915","54":"30932","55":"0.146296","56":"722","57":"0.003415","58":"125010","59":"0.591247","60":"8382886","61":"39.64770","62":"6","63":"2.8e-05","64":"358","65":"0.001693","66":"3","67":"1.4e-05","68":"1","69":"5e-06","70":"530","71":"0.002507","72":"NA","73":"NA","74":"454","75":"0.002147","76":"10207","77":"0.048275","78":"1870","79":"0.008844","80":"5","81":"2.4e-05","82":"915","83":"0.004328","84":"61","85":"0.000289","86":"4","87":"1.9e-05","88":"310","89":"0.001466","90":"3","91":"1.4e-05","92":"43","93":"0.000203","94":"6","95":"2.8e-05","96":"42","97":"0.000199","98":"35031","99":"0.165683","100":"1252868","101":"5.925565","102":"1246143","103":"5.893758","104":"192099","105":"0.908551","106":"2057338","107":"9.730386","108":"7903237","109":"37.37915","110":"4254","111":"0.020120","112":"8383568","113":"39.65093","114":"362","115":"0.001712","116":"530","117":"0.002507","118":"13451","119":"0.063618","120":"75","121":"0.000355","122":"1252868","123":"5.925565","124":"65659","125":"0.310541","126":"23852","127":"0.112810","128":"3713295","129":"1861933","130":"1.994323","131":"2556640","132":"1509294","133":"0","134":"hapmap","135":"45.75","136":"99.09","137":"3465116","138":"1879862","139":"3421917","140":"3465116","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.48","151":"A","152":"1185838","153":"420138446","154":"18908318","155":"483800","156":"41401574","157":"8561816","158":"0.098979","159":"2440020860","160":"82803148","161":"757473744","162":"702038","163":"17123632","164":"65679516","165":"483800","166":"18908318","167":"199994","168":"0","169":"0","170":"6746","171":"3.37","172":"194410","173":"97.21","174":"19885","175":"9.94","176":"10","177":"0.01","178":"18445","179":"9.22","180":"5519","181":"2.76","182":"P4107_1002_S2_L003_R2_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"430185524","186":"0","187":"151","188":"41","189":"97.84192","190":"151","191":"pass","192":"pass","193":"fail","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"warn","201":"pass","202":"fail","203":"41.29062","204":"367","205":"92.29794","206":"92.22694","207":"92.07669","208":"82.33886","209":"15.934603","210":"40","211":"97.81653","212":"847067526","213":"865975844","214":"762","215":"1.994323","216":"4067653","217":"2.07","218":"1.48","219":"0.098979","220":"2.158076","221":"41","222":"151","223":"16.666667","224":"430185524"},{"1":"P4107_1006","2":"/scratch/108820/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1006.clean.dedup.bam","3":"912383669","4":"894970438","5":"132096608584","6":"132012607144","7":"30869.34","8":"360","9":"50.33","10":"42.59","11":"98.09146","12":"GRCh37.75","13":"4072161","14":"3872603","15":"95.09946","16":"21155209","17":"32036512383","18":"3101541615","19":"761","20":"1309","21":"0.006188","22":"8428017","23":"39.83897","24":"38700","25":"0.182934","26":"12687183","27":"59.97191","28":"31791","29":"46.62052","30":"315","31":"0.461938","32":"36085","33":"52.91754","34":"0.881003","35":"Count","36":"65469","37":"0.309470","38":"3038","39":"0.014361","40":"20738","41":"0.098028","42":"4237","43":"0.020028","44":"1247269","45":"5.895801","46":"8","47":"3.8e-05","48":"2060065","49":"9.737862","50":"675","51":"0.003191","52":"7910832","53":"37.39425","54":"30926","55":"0.146186","56":"739","57":"0.003493","58":"124984","59":"0.590795","60":"8381858","61":"39.62078","62":"6","63":"2.8e-05","64":"359","65":"0.001697","66":"3","67":"1.4e-05","68":"1","69":"5e-06","70":"513","71":"0.002425","72":"NA","73":"NA","74":"450","75":"0.002127","76":"10247","77":"0.048437","78":"1865","79":"0.008816","80":"5","81":"2.4e-05","82":"904","83":"0.004273","84":"61","85":"0.000288","86":"4","87":"1.9e-05","88":"312","89":"0.001475","90":"3","91":"1.4e-05","92":"45","93":"0.000213","94":"8","95":"3.8e-05","96":"45","97":"0.000213","98":"35131","99":"0.166063","100":"1254409","101":"5.929551","102":"1247269","103":"5.895801","104":"192193","105":"0.908490","106":"2060065","107":"9.737862","108":"7910832","109":"37.39425","110":"4237","111":"0.020028","112":"8382539","113":"39.62400","114":"363","115":"0.001716","116":"513","117":"0.002425","118":"13471","119":"0.063677","120":"73","121":"0.000345","122":"1254409","123":"5.929551","124":"65469","125":"0.309470","126":"23776","127":"0.112388","128":"3716115","129":"1864190","130":"1.993421","131":"2560545","132":"1509880","133":"0","134":"hapmap","135":"45.91","136":"99.10","137":"3452732","138":"1867441","139":"3410273","140":"3452732","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.48","151":"A","152":"1310769","153":"443876610","154":"17413231","155":"556444","156":"55005596","157":"13645138","158":"0.124364","159":"2091799585","160":"110011192","161":"777742028","162":"754325","163":"27290276","164":"82720916","165":"556444","166":"17413231","167":"200018","168":"0","169":"0","170":"6755","171":"3.37","172":"194934","173":"97.46","174":"19868","175":"9.93","176":"5","177":"0.00","178":"18447","179":"9.21","180":"5020","181":"2.51","182":"P4107_1006_S6_L007_R2_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"453238610","186":"0","187":"151","188":"41","189":"98.22412","190":"151","191":"pass","192":"pass","193":"warn","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"warn","201":"pass","202":"fail","203":"41.26998","204":"362","205":"92.29880","206":"92.23074","207":"92.10217","208":"84.09636","209":"23.664833","210":"43","211":"98.09146","212":"894970438","213":"912383669","214":"761","215":"1.993421","216":"4072161","217":"2.07","218":"1.48","219":"0.124364","220":"1.775882","221":"41","222":"151","223":"8.333333","224":"453238610"},{"1":"P4107_1001","2":"/scratch/108823/ANALYSIS/P4107/piper_ngi/05_processed_alignments/P4107_1001.clean.dedup.bam","3":"772071557","4":"751147332","5":"110979222236","6":"110894377611","7":"28931.62","8":"355","9":"50.32","10":"35.78","11":"97.28986","12":"GRCh37.75","13":"4059325","14":"3864874","15":"95.20977","16":"21116726","17":"32036512383","18":"3101541615","19":"764","20":"1296","21":"0.006137","22":"8421056","23":"39.87861","24":"38519","25":"0.182410","26":"12655855","27":"59.93285","28":"31604","29":"46.58402","30":"311","31":"0.458411","32":"35928","33":"52.95756","34":"0.879648","35":"Count","36":"65517","37":"0.310261","38":"3029","39":"0.014344","40":"20806","41":"0.098529","42":"4226","43":"0.020013","44":"1243319","45":"5.887840","46":"10","47":"4.7e-05","48":"2052490","49":"9.719736","50":"675","51":"0.003197","52":"7895710","53":"37.39079","54":"30730","55":"0.145524","56":"747","57":"0.003537","58":"124583","59":"0.589973","60":"8375083","61":"39.66090","62":"6","63":"2.8e-05","64":"370","65":"0.001752","66":"5","67":"2.4e-05","68":"1","69":"5e-06","70":"492","71":"0.002330","72":"NA","73":"NA","74":"462","75":"0.002188","76":"10231","77":"0.048450","78":"1838","79":"0.008704","80":"5","81":"2.4e-05","82":"892","83":"0.004224","84":"61","85":"0.000289","86":"4","87":"1.9e-05","88":"309","89":"0.001463","90":"2","91":"9.0e-06","92":"44","93":"0.000208","94":"8","95":"3.8e-05","96":"43","97":"0.000204","98":"34988","99":"0.165689","100":"1250040","101":"5.919668","102":"1243319","103":"5.887840","104":"191454","105":"0.906646","106":"2052490","107":"9.719736","108":"7895710","109":"37.39079","110":"4226","111":"0.020013","112":"8375764","113":"39.66412","114":"376","115":"0.001781","116":"492","117":"0.002330","118":"13428","119":"0.063589","120":"75","121":"0.000355","122":"1250040","123":"5.919668","124":"65517","125":"0.310261","126":"23835","127":"0.112873","128":"3708090","129":"1858534","130":"1.995169","131":"2548668","132":"1508978","133":"0","134":"hapmap","135":"45.44","136":"99.09","137":"3490344","138":"1904260","139":"3437854","140":"3490344","141":"0","142":"0","143":"0","144":"0","145":"0","146":"0","147":"0","148":"hapmap","149":"2.07","150":"1.49","151":"A","152":"1351481","153":"372454903","154":"20924225","155":"449788","156":"23612037","157":"4105864","158":"0.063884","159":"3354000974","160":"47224074","161":"697685732","162":"901693","163":"8211728","164":"39012346","165":"449788","166":"20924225","167":"199997","168":"0","169":"0","170":"6670","171":"3.34","172":"193400","173":"96.70","174":"19626","175":"9.81","176":"7","177":"0.00","178":"18386","179":"9.19","180":"6539","181":"3.27","182":"P4107_1001_S1_L002_R2_001.fastq.gz","183":"Conventional base calls","184":"Sanger / Illumina 1.9","185":"383592756","186":"0","187":"151","188":"41","189":"96.30671","190":"151","191":"pass","192":"pass","193":"warn","194":"pass","195":"warn","196":"warn","197":"pass","198":"pass","199":"pass","200":"fail","201":"pass","202":"fail","203":"41.36746","204":"358","205":"92.29433","206":"92.21026","207":"91.96108","208":"74.66019","209":"5.240211","210":"36","211":"97.28986","212":"751147332","213":"772071557","214":"764","215":"1.995169","216":"4059325","217":"2.07","218":"1.49","219":"0.063884","220":"3.693292","221":"41","222":"151","223":"16.666667","224":"383592756"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Often you won’t care about fields like <code>raw.qualimap_bamqc_genome_results.bam_file</code>, the path to the original BAM file, but ‘raw’ at least provides this option.</p>
<p>You can also combine both <code>general</code> and <code>raw</code> sections by passing in a longer vector:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_both</span> <span class="op">=</span> <span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/load_multiqc.html">load_multiqc</a></span><span class="op">(</span><span class="va">multiqc_data_path</span>, sections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'raw'</span>, <span class="st">'general'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_both</span><span class="op">)</span>
<span class="co">#&gt; [1] 388</span></code></pre></div>
<p>That’s a lot of columns!</p>
</div>
<div id="uses" class="section level2">
<h2 class="hasAnchor">
<a href="#uses" class="anchor"></a>Uses</h2>
<p>This section will briefly talk about some downstream use-cases for this package.</p>
<div id="plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h3>
<p>One use for this data frame is creating QC plots. For example, to visualise the duplication rate per sample:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">metadata.sample_id</span>, y<span class="op">=</span><span class="va">general.percent_duplication</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="TidyMultiqc_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Of course, this is basically just replicating a plot already in the MultiQC report, but now we can customise it how we like!</p>
</div>
<div id="hypothesis-testing" class="section level3">
<h3 class="hasAnchor">
<a href="#hypothesis-testing" class="anchor"></a>Hypothesis Testing</h3>
<p>With all this data, we might also want to test a specific hypothesis! For example, we might want to test the hypothesis that the mean GC content is the same as the mean GC content in the human genome (41%). If we assume that GC content is normally distributed, we can do the following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">general.percent_gc</span>, mu<span class="op">=</span><span class="fl">41</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  df$general.percent_gc</span>
<span class="co">#&gt; t = -1, df = 5, p-value = 0.3632</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 41</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  40.40490 41.26176</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;  40.83333</span></code></pre></div>
<p>It seems that we cannot reject this hypothesis, so these may well be human samples!</p>
</div>
</div>
<div id="extracting-plot-data" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-plot-data" class="anchor"></a>Extracting Plot Data</h2>
<div id="motivation" class="section level3">
<h3 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h3>
<p>It is occasionally useful to extract QC data from the MultiQC plots. For example, let’s say we want to calculate the median quality score of every base in each sample. Unfortunately, MultiQC provides no numerical summary statistic for the read quality, it only has mapping quality and pass/fails for the per-base sequence quality:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_both</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">'quality'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["raw.qualimap_bamqc_genome_results.mean_mapping_quality"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.sequences_flagged_as_poor_quality"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["raw.fastqc.per_base_sequence_quality"],"name":[3],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_tile_sequence_quality"],"name":[4],"type":["chr"],"align":["left"]},{"label":["raw.fastqc.per_sequence_quality_scores"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"50.34","2":"0","3":"pass","4":"warn","5":"pass"},{"1":"50.37","2":"0","3":"pass","4":"fail","5":"pass"},{"1":"50.34","2":"0","3":"pass","4":"warn","5":"pass"},{"1":"50.33","2":"0","3":"pass","4":"fail","5":"pass"},{"1":"50.33","2":"0","3":"pass","4":"warn","5":"pass"},{"1":"50.32","2":"0","3":"pass","4":"warn","5":"pass"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>However, our MultiQC report does have <em>plots</em> that contain this information. In particular, let’s look at the “Per Sequence Quality Scores” plot.</p>
</div>
<div id="listing-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#listing-plots" class="anchor"></a>Listing Plots</h3>
<p>Firstly, we need the ID of the plot we want. This isn’t necessarily obvious from just looking at the report, so we can use a utility function here:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/list_plots.html">list_plots</a></span><span class="op">(</span><span class="va">multiqc_data_path</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"qualimap_coverage_histogram","2":"Qualimap BamQC: Coverage histogram"},{"1":"qualimap_genome_fraction","2":"Qualimap BamQC: Genome fraction covered by at l..."},{"1":"qualimap_insert_size","2":"Qualimap BamQC: Insert size histogram"},{"1":"qualimap_gc_content","2":"Qualimap BamQC: GC content distribution"},{"1":"snpeff_variant_effects_region","2":"SnpEff: Counts by Genomic Region"},{"1":"snpeff_variant_effects_impact","2":"SnpEff: Counts by Effects Impact"},{"1":"snpeff_effects","2":"SnpEff: Counts by Effect Types"},{"1":"snpeff_variant_effects_class","2":"SnpEff: Counts by Functional Class"},{"1":"snpeff_qualities","2":"SnpEff: Qualities"},{"1":"gatk_varianteval_variant_plot","2":"GATK VariantEval: Variant Counts"},{"1":"picard_deduplication","2":"Picard: Deduplication Stats"},{"1":"fastqc_sequence_counts_plot","2":"FastQC: Sequence Counts"},{"1":"fastqc_per_base_sequence_quality_plot","2":"FastQC: Mean Quality Scores"},{"1":"fastqc_per_sequence_quality_scores_plot","2":"FastQC: Per Sequence Quality Scores"},{"1":"fastqc_per_sequence_gc_content_plot","2":"FastQC: Per Sequence GC Content"},{"1":"fastqc_per_base_n_content_plot","2":"FastQC: Per Base N Content"},{"1":"fastqc_sequence_duplication_levels_plot","2":"FastQC: Sequence Duplication Levels"},{"1":"fastqc_overrepresented_sequencesi_plot","2":"FastQC: Overrepresented sequences"},{"1":"fastqc_adapter_content_plot","2":"FastQC: Adapter Content"},{"1":"fastqc-status-check-heatmap","2":"FastQC: Status Checks"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Now, we know we want the “Per Sequence Quality Scores” plot, and by looking at the data frame above we can tell that the corresponding ID is <code>fastqc_per_sequence_quality_scores_plot</code>.</p>
</div>
<div id="loading-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-plots" class="anchor"></a>Loading Plots</h3>
<p>Now that we have the plot ID, we can load the plot data. First, we need to tell <code>TidyMultiqc</code> to load include some plots by using <code>sections = "plot"</code> (you can load other sections at the same time, as explained above). Also, we need to pass the plot ID from the previous step into the <code>plots</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/load_multiqc.html">load_multiqc</a></span><span class="op">(</span>
  <span class="va">multiqc_data_path</span>, 
  sections <span class="op">=</span> <span class="st">'plot'</span>,
  plots <span class="op">=</span> <span class="st">"fastqc_per_sequence_quality_scores_plot"</span>
<span class="op">)</span>
<span class="va">df</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["plot.fastqc_per_sequence_quality_scores_plot"],"name":[2],"type":["list"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"<tibble[,2]>"},{"1":"P4107_1002","2":"<tibble[,2]>"},{"1":"P4107_1003","2":"<tibble[,2]>"},{"1":"P4107_1004","2":"<tibble[,2]>"},{"1":"P4107_1005","2":"<tibble[,2]>"},{"1":"P4107_1006","2":"<tibble[,2]>"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We now have the plot data, but it’s not in a very usable form! This is because each sample has an entire data frame of plot data. At this point if you’re comfortable using <code>dplyr</code> and <code>tidyr</code> to deal with nested data frames, you probably know what to do. Otherwise, read on.</p>
</div>
<div id="converting-plot-data" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-plot-data" class="anchor"></a>Converting Plot Data</h3>
<p>Recall that we are after the median quality score of each sample. First, we should look at the plot data for a single sample to know what we’re dealing with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">plot.fastqc_per_sequence_quality_scores_plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"7","2":"2"},{"1":"8","2":"13"},{"1":"9","2":"121"},{"1":"10","2":"702"},{"1":"11","2":"3962"},{"1":"12","2":"11946"},{"1":"13","2":"33566"},{"1":"14","2":"77653"},{"1":"15","2":"157422"},{"1":"16","2":"294209"},{"1":"17","2":"492475"},{"1":"18","2":"720687"},{"1":"19","2":"963842"},{"1":"20","2":"1219092"},{"1":"21","2":"1516173"},{"1":"22","2":"1885944"},{"1":"23","2":"2388458"},{"1":"24","2":"3233075"},{"1":"25","2":"4949305"},{"1":"26","2":"4684978"},{"1":"27","2":"4090747"},{"1":"28","2":"4478935"},{"1":"29","2":"5015234"},{"1":"30","2":"5656014"},{"1":"31","2":"6451225"},{"1":"32","2":"7424908"},{"1":"33","2":"8637645"},{"1":"34","2":"10176351"},{"1":"35","2":"12193425"},{"1":"36","2":"14987094"},{"1":"37","2":"19130838"},{"1":"38","2":"26042098"},{"1":"39","2":"39815694"},{"1":"40","2":"76771779"},{"1":"41","2":"120087144"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>So each data frame is a set of x, y pairs. As it’s a histogram plot, we know that the <code>x</code> value is the quality score, and <code>y</code> is the number of times that score has been counted.</p>
<!-- Now, if we just wanted a simple statistic, like the number of times the quality score was 30 (not a very useful metric in reality), we could pull out this value from the data frame. -->
<!-- But remember, we are actually dealing with a list of data frames, so we will have to use a `purrr::map` function to help here: -->
<!-- ```{r} -->
<!-- df %>% -->
<!--   dplyr::mutate(q30s = purrr::map_dbl(plot.fastqc_per_sequence_quality_scores_plot, function(plot_df){ -->
<!--     plot_df %>% -->
<!--       dplyr::filter(x == 30) %>% -->
<!--       dplyr::pull(y) -->
<!--   })) -->
<!-- ``` -->
<!-- Note as well that we used `purrr::map_dbl` here, since the final column was a double-typed vector. -->
</div>
<div id="unnesting" class="section level3">
<h3 class="hasAnchor">
<a href="#unnesting" class="anchor"></a>Unnesting</h3>
<p>One possible way to process this nested data is to use <code>tidyr</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">plot.fastqc_per_sequence_quality_scores_plot</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"7","3":"2"},{"1":"P4107_1001","2":"8","3":"13"},{"1":"P4107_1001","2":"9","3":"121"},{"1":"P4107_1001","2":"10","3":"702"},{"1":"P4107_1001","2":"11","3":"3962"},{"1":"P4107_1001","2":"12","3":"11946"},{"1":"P4107_1001","2":"13","3":"33566"},{"1":"P4107_1001","2":"14","3":"77653"},{"1":"P4107_1001","2":"15","3":"157422"},{"1":"P4107_1001","2":"16","3":"294209"},{"1":"P4107_1001","2":"17","3":"492475"},{"1":"P4107_1001","2":"18","3":"720687"},{"1":"P4107_1001","2":"19","3":"963842"},{"1":"P4107_1001","2":"20","3":"1219092"},{"1":"P4107_1001","2":"21","3":"1516173"},{"1":"P4107_1001","2":"22","3":"1885944"},{"1":"P4107_1001","2":"23","3":"2388458"},{"1":"P4107_1001","2":"24","3":"3233075"},{"1":"P4107_1001","2":"25","3":"4949305"},{"1":"P4107_1001","2":"26","3":"4684978"},{"1":"P4107_1001","2":"27","3":"4090747"},{"1":"P4107_1001","2":"28","3":"4478935"},{"1":"P4107_1001","2":"29","3":"5015234"},{"1":"P4107_1001","2":"30","3":"5656014"},{"1":"P4107_1001","2":"31","3":"6451225"},{"1":"P4107_1001","2":"32","3":"7424908"},{"1":"P4107_1001","2":"33","3":"8637645"},{"1":"P4107_1001","2":"34","3":"10176351"},{"1":"P4107_1001","2":"35","3":"12193425"},{"1":"P4107_1001","2":"36","3":"14987094"},{"1":"P4107_1001","2":"37","3":"19130838"},{"1":"P4107_1001","2":"38","3":"26042098"},{"1":"P4107_1001","2":"39","3":"39815694"},{"1":"P4107_1001","2":"40","3":"76771779"},{"1":"P4107_1001","2":"41","3":"120087144"},{"1":"P4107_1002","2":"4","3":"25"},{"1":"P4107_1002","2":"5","3":"139"},{"1":"P4107_1002","2":"6","3":"585"},{"1":"P4107_1002","2":"7","3":"1304"},{"1":"P4107_1002","2":"8","3":"2821"},{"1":"P4107_1002","2":"9","3":"2098"},{"1":"P4107_1002","2":"10","3":"2606"},{"1":"P4107_1002","2":"11","3":"6814"},{"1":"P4107_1002","2":"12","3":"16942"},{"1":"P4107_1002","2":"13","3":"37242"},{"1":"P4107_1002","2":"14","3":"73652"},{"1":"P4107_1002","2":"15","3":"142281"},{"1":"P4107_1002","2":"16","3":"260519"},{"1":"P4107_1002","2":"17","3":"436736"},{"1":"P4107_1002","2":"18","3":"643278"},{"1":"P4107_1002","2":"19","3":"858052"},{"1":"P4107_1002","2":"20","3":"1079212"},{"1":"P4107_1002","2":"21","3":"1331165"},{"1":"P4107_1002","2":"22","3":"1635514"},{"1":"P4107_1002","2":"23","3":"2065815"},{"1":"P4107_1002","2":"24","3":"2771904"},{"1":"P4107_1002","2":"25","3":"4013731"},{"1":"P4107_1002","2":"26","3":"3899894"},{"1":"P4107_1002","2":"27","3":"3734971"},{"1":"P4107_1002","2":"28","3":"4188151"},{"1":"P4107_1002","2":"29","3":"4732353"},{"1":"P4107_1002","2":"30","3":"5379255"},{"1":"P4107_1002","2":"31","3":"6196752"},{"1":"P4107_1002","2":"32","3":"7216376"},{"1":"P4107_1002","2":"33","3":"8511646"},{"1":"P4107_1002","2":"34","3":"10214246"},{"1":"P4107_1002","2":"35","3":"12531450"},{"1":"P4107_1002","2":"36","3":"15780505"},{"1":"P4107_1002","2":"37","3":"20674446"},{"1":"P4107_1002","2":"38","3":"29362020"},{"1":"P4107_1002","2":"39","3":"47669147"},{"1":"P4107_1002","2":"40","3":"93655368"},{"1":"P4107_1002","2":"41","3":"141056509"},{"1":"P4107_1003","2":"11","3":"53"},{"1":"P4107_1003","2":"12","3":"131"},{"1":"P4107_1003","2":"13","3":"241"},{"1":"P4107_1003","2":"14","3":"713"},{"1":"P4107_1003","2":"15","3":"2300"},{"1":"P4107_1003","2":"16","3":"6178"},{"1":"P4107_1003","2":"17","3":"15427"},{"1":"P4107_1003","2":"18","3":"35973"},{"1":"P4107_1003","2":"19","3":"74954"},{"1":"P4107_1003","2":"20","3":"133756"},{"1":"P4107_1003","2":"21","3":"214521"},{"1":"P4107_1003","2":"22","3":"332873"},{"1":"P4107_1003","2":"23","3":"625270"},{"1":"P4107_1003","2":"24","3":"1873645"},{"1":"P4107_1003","2":"25","3":"2263770"},{"1":"P4107_1003","2":"26","3":"1288657"},{"1":"P4107_1003","2":"27","3":"1362434"},{"1":"P4107_1003","2":"28","3":"1720050"},{"1":"P4107_1003","2":"29","3":"2211087"},{"1":"P4107_1003","2":"30","3":"2812069"},{"1":"P4107_1003","2":"31","3":"3521357"},{"1":"P4107_1003","2":"32","3":"4366396"},{"1":"P4107_1003","2":"33","3":"5352039"},{"1":"P4107_1003","2":"34","3":"6527855"},{"1":"P4107_1003","2":"35","3":"7951809"},{"1":"P4107_1003","2":"36","3":"9782576"},{"1":"P4107_1003","2":"37","3":"12356832"},{"1":"P4107_1003","2":"38","3":"16488919"},{"1":"P4107_1003","2":"39","3":"24750325"},{"1":"P4107_1003","2":"40","3":"50915004"},{"1":"P4107_1003","2":"41","3":"274391786"},{"1":"P4107_1004","2":"10","3":"8"},{"1":"P4107_1004","2":"11","3":"240"},{"1":"P4107_1004","2":"12","3":"415"},{"1":"P4107_1004","2":"13","3":"592"},{"1":"P4107_1004","2":"14","3":"1176"},{"1":"P4107_1004","2":"15","3":"3243"},{"1":"P4107_1004","2":"16","3":"7274"},{"1":"P4107_1004","2":"17","3":"15521"},{"1":"P4107_1004","2":"18","3":"32396"},{"1":"P4107_1004","2":"19","3":"63717"},{"1":"P4107_1004","2":"20","3":"110921"},{"1":"P4107_1004","2":"21","3":"171625"},{"1":"P4107_1004","2":"22","3":"255367"},{"1":"P4107_1004","2":"23","3":"435504"},{"1":"P4107_1004","2":"24","3":"1104544"},{"1":"P4107_1004","2":"25","3":"1341224"},{"1":"P4107_1004","2":"26","3":"827368"},{"1":"P4107_1004","2":"27","3":"954386"},{"1":"P4107_1004","2":"28","3":"1232766"},{"1":"P4107_1004","2":"29","3":"1588433"},{"1":"P4107_1004","2":"30","3":"2009942"},{"1":"P4107_1004","2":"31","3":"2505847"},{"1":"P4107_1004","2":"32","3":"3106641"},{"1":"P4107_1004","2":"33","3":"3835395"},{"1":"P4107_1004","2":"34","3":"4730571"},{"1":"P4107_1004","2":"35","3":"5885516"},{"1":"P4107_1004","2":"36","3":"7446809"},{"1":"P4107_1004","2":"37","3":"9790707"},{"1":"P4107_1004","2":"38","3":"13723853"},{"1":"P4107_1004","2":"39","3":"22000798"},{"1":"P4107_1004","2":"40","3":"50029383"},{"1":"P4107_1004","2":"41","3":"364953217"},{"1":"P4107_1005","2":"2","3":"1"},{"1":"P4107_1005","2":"3","3":"119"},{"1":"P4107_1005","2":"4","3":"686"},{"1":"P4107_1005","2":"5","3":"624"},{"1":"P4107_1005","2":"6","3":"955"},{"1":"P4107_1005","2":"7","3":"661"},{"1":"P4107_1005","2":"8","3":"730"},{"1":"P4107_1005","2":"9","3":"1166"},{"1":"P4107_1005","2":"10","3":"3056"},{"1":"P4107_1005","2":"11","3":"11132"},{"1":"P4107_1005","2":"12","3":"26048"},{"1":"P4107_1005","2":"13","3":"54367"},{"1":"P4107_1005","2":"14","3":"99661"},{"1":"P4107_1005","2":"15","3":"176234"},{"1":"P4107_1005","2":"16","3":"296539"},{"1":"P4107_1005","2":"17","3":"454566"},{"1":"P4107_1005","2":"18","3":"631059"},{"1":"P4107_1005","2":"19","3":"817658"},{"1":"P4107_1005","2":"20","3":"1013795"},{"1":"P4107_1005","2":"21","3":"1236375"},{"1":"P4107_1005","2":"22","3":"1500932"},{"1":"P4107_1005","2":"23","3":"1829820"},{"1":"P4107_1005","2":"24","3":"2338522"},{"1":"P4107_1005","2":"25","3":"3607447"},{"1":"P4107_1005","2":"26","3":"3825112"},{"1":"P4107_1005","2":"27","3":"3602005"},{"1":"P4107_1005","2":"28","3":"4043534"},{"1":"P4107_1005","2":"29","3":"4569951"},{"1":"P4107_1005","2":"30","3":"5196655"},{"1":"P4107_1005","2":"31","3":"5974887"},{"1":"P4107_1005","2":"32","3":"6943973"},{"1":"P4107_1005","2":"33","3":"8150541"},{"1":"P4107_1005","2":"34","3":"9720403"},{"1":"P4107_1005","2":"35","3":"11870874"},{"1":"P4107_1005","2":"36","3":"14962601"},{"1":"P4107_1005","2":"37","3":"19846197"},{"1":"P4107_1005","2":"38","3":"28547559"},{"1":"P4107_1005","2":"39","3":"47793557"},{"1":"P4107_1005","2":"40","3":"106696068"},{"1":"P4107_1005","2":"41","3":"188387356"},{"1":"P4107_1006","2":"2","3":"257"},{"1":"P4107_1006","2":"3","3":"140"},{"1":"P4107_1006","2":"4","3":"247"},{"1":"P4107_1006","2":"5","3":"640"},{"1":"P4107_1006","2":"6","3":"2061"},{"1":"P4107_1006","2":"7","3":"3876"},{"1":"P4107_1006","2":"8","3":"2156"},{"1":"P4107_1006","2":"9","3":"2675"},{"1":"P4107_1006","2":"10","3":"4007"},{"1":"P4107_1006","2":"11","3":"12792"},{"1":"P4107_1006","2":"12","3":"32360"},{"1":"P4107_1006","2":"13","3":"76898"},{"1":"P4107_1006","2":"14","3":"154000"},{"1":"P4107_1006","2":"15","3":"268598"},{"1":"P4107_1006","2":"16","3":"434660"},{"1":"P4107_1006","2":"17","3":"649473"},{"1":"P4107_1006","2":"18","3":"893546"},{"1":"P4107_1006","2":"19","3":"1157234"},{"1":"P4107_1006","2":"20","3":"1435336"},{"1":"P4107_1006","2":"21","3":"1749248"},{"1":"P4107_1006","2":"22","3":"2107005"},{"1":"P4107_1006","2":"23","3":"2535756"},{"1":"P4107_1006","2":"24","3":"3153180"},{"1":"P4107_1006","2":"25","3":"4218597"},{"1":"P4107_1006","2":"26","3":"4401416"},{"1":"P4107_1006","2":"27","3":"4510035"},{"1":"P4107_1006","2":"28","3":"5050153"},{"1":"P4107_1006","2":"29","3":"5670374"},{"1":"P4107_1006","2":"30","3":"6412524"},{"1":"P4107_1006","2":"31","3":"7305795"},{"1":"P4107_1006","2":"32","3":"8413673"},{"1":"P4107_1006","2":"33","3":"9793420"},{"1":"P4107_1006","2":"34","3":"11569918"},{"1":"P4107_1006","2":"35","3":"13951919"},{"1":"P4107_1006","2":"36","3":"17319076"},{"1":"P4107_1006","2":"37","3":"22462006"},{"1":"P4107_1006","2":"38","3":"31296445"},{"1":"P4107_1006","2":"39","3":"49758271"},{"1":"P4107_1006","2":"40","3":"100055550"},{"1":"P4107_1006","2":"41","3":"136373293"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As you can see, if we unnest in this way, we now have multiple rows for the same sample, which is a bit confusing (and not Tidy). However, if we use <code>group_by</code> and then <code>summarise</code>, this can be a useful way to calculate summary statistics. For example, if we want the total number of reads, we could do the following:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">plot.fastqc_per_sequence_quality_scores_plot</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">metadata.sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>total_reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["total_reads"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"383592756"},{"1":"P4107_1002","2":"430185524"},{"1":"P4107_1003","2":"431379000"},{"1":"P4107_1004","2":"498165399"},{"1":"P4107_1005","2":"484233426"},{"1":"P4107_1006","2":"453238610"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="mapping-with-purrr" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-with-purrr" class="anchor"></a>Mapping with Purrr</h3>
<p>Although unnesting worked well in this example, it can get a bit awkward for more complex operations. In these cases we can use <code>purrr</code>. Refer to the next section for an example that compares both approaches. The below example sums the number of reads for each sample, as we have done above, but this time it uses <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map_dbl</a></code> to map over the list of data frames:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    total_reads <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">plot.fastqc_per_sequence_quality_scores_plot</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,
    plot.fastqc_per_sequence_quality_scores_plot <span class="op">=</span> <span class="cn">NULL</span>
  <span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["total_reads"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"383592756"},{"1":"P4107_1002","2":"430185524"},{"1":"P4107_1003","2":"431379000"},{"1":"P4107_1004","2":"498165399"},{"1":"P4107_1005","2":"484233426"},{"1":"P4107_1006","2":"453238610"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="properly-handling-histogram-data" class="section level3">
<h3 class="hasAnchor">
<a href="#properly-handling-histogram-data" class="anchor"></a>Properly Handling Histogram Data</h3>
<p>Of course, we actually want to find the median here, which is a bit harder. Luckily there exists a package called <code>HistDat</code> for generating summary statistics from histogram-type data. You can check out the package’s manual and vignettes <a href="https://cran.r-project.org/package=HistDat">here</a>, but in brief, we want to convert each of these plot data frames into a <code>HistDat</code> object, which we can do using the same strategies as before. Then, using <code>HistDat</code>, we can calculate our summary statistics in one of the two ways mentioned above.</p>
<p>Using the <code>tidyr</code> approach, we can unnest the plot data, group it, create a <code>HistDat</code> object for each group, and then produce new columns using the new <code>hist</code> column:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">plot.fastqc_per_sequence_quality_scores_plot</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">metadata.sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">HistDat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/HistDat/man/HistDat.html">HistDat</a></span><span class="op">(</span>vals <span class="op">=</span> <span class="va">x</span>, counts <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span>, .keep <span class="op">=</span> <span class="st">"unused"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    mean_coverage <span class="op">=</span> <span class="va">hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span>,
    median_coverage <span class="op">=</span> <span class="va">hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="op">)</span>,
    max_coverage <span class="op">=</span> <span class="va">hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">)</span>,
    hist<span class="op">=</span> <span class="cn">NULL</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean_coverage"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median_coverage"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max_coverage"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"37.42207","3":"40","4":"41"},{"1":"P4107_1002","2":"37.86446","3":"40","4":"41"},{"1":"P4107_1003","2":"39.43982","3":"41","4":"41"},{"1":"P4107_1004","2":"39.97978","3":"41","4":"41"},{"1":"P4107_1005","2":"38.30061","3":"40","4":"41"},{"1":"P4107_1006","2":"37.56991","3":"40","4":"41"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Alternatively, using the <code>purrr</code> method, we can just map each plot data frame into a row of summary statistics. Much neater!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfr</a></span><span class="op">(</span><span class="va">plot.fastqc_per_sequence_quality_scores_plot</span>, <span class="kw">function</span><span class="op">(</span><span class="va">plot_df</span><span class="op">)</span><span class="op">{</span>
      <span class="va">hist</span> <span class="op">=</span> <span class="fu">HistDat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/HistDat/man/HistDat.html">HistDat</a></span><span class="op">(</span>vals<span class="op">=</span><span class="va">plot_df</span><span class="op">$</span><span class="va">x</span>, counts <span class="op">=</span> <span class="va">plot_df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        mean_coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hist</span><span class="op">)</span>,
        median_coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">hist</span><span class="op">)</span>,
        max_coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">hist</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>,
    plot.fastqc_per_sequence_quality_scores_plot <span class="op">=</span> <span class="cn">NULL</span>
  <span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean_coverage"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median_coverage"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max_coverage"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"P4107_1001","2":"37.42207","3":"40","4":"41"},{"1":"P4107_1002","2":"37.86446","3":"40","4":"41"},{"1":"P4107_1003","2":"39.43982","3":"41","4":"41"},{"1":"P4107_1004","2":"39.97978","3":"41","4":"41"},{"1":"P4107_1005","2":"38.30061","3":"40","4":"41"},{"1":"P4107_1006","2":"37.56991","3":"40","4":"41"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="custom-plot-parsers" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-plot-parsers" class="anchor"></a>Custom Plot Parsers</h3>
<p>So far, we have used <code>TidyMultiqc</code>’s built-in parsers. Each parser is a function that converts the plot JSON into a list of data frames. However, it is possible that we might encounter a new type of plot that is not yet implemented in <code>TidyMultiqc</code>. If this happens, the first thing you should do is <a href="https://github.com/multimeric/TidyMultiqc/issues">file an issue against this package</a>.</p>
<p>Then, if you’re daring, you can try to implement a parser. For your reference, you can refer to the existing parsers in the source code. Then, you can pass in your custom parser using the <code>plot_parsers</code> argument to <code>load_multiqc</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">TidyMultiqc</span><span class="fu">::</span><span class="fu"><a href="../reference/load_multiqc.html">load_multiqc</a></span><span class="op">(</span>
  <span class="va">multiqc_data_path</span>, 
  sections <span class="op">=</span> <span class="st">'plot'</span>,
  plots <span class="op">=</span> <span class="st">"fastqc_per_sequence_quality_scores_plot"</span>,
  plot_parsers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="co"># This fake parser function takes a plot and just returns the iris dataset</span>
    xy_line <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">name</span><span class="op">)</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        sample_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
          plot_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
        <span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["metadata.sample_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["plot_name"],"name":[2],"type":["list"],"align":["right"]}],"data":[{"1":"sample_1","2":"<df[,5] [150 × 5]>"}],"options":{"columns":{"min":{},"max":[3]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Finally, if your parser works, please submit a pull request to <code>TidyMultiqc</code> to share this with everyone!</p>
<p>Using the strategies and patterns explained in this section, you should be in good stead to handle whatever plots <code>multiqc</code> throws at you.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Milton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
